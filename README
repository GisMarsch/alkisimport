ALKIS-Werkzeuge
===============

1. Importwerkzeuge
2. ALKIS-Plugin für QGIS

Importwerkzeuge
---------------

Die Importwerkzeuge befinden sich im Verzeichnis norGIS-ALKIS-Import.

Es gibt das Shellskript alkis-import.sh mit dem man Daten ohne Oberfläche
einspielen kann und alkisImport.py, dass eine PyQt-Oberfläche zur Verfügung
stellt.

Unter Windows wird für das Shellskript cygwin vorausgesetzt und für
alkisImport.py OSGeo4W 32bit (am einfachsten QGIS installieren, dann sind alle
Abhängigkeiten vorhanden; sonst python, PyQt4, QtSql-Treiber für PostgreSQL,
ggf. mapscript für python).  Das Python-Skript kann man per alkis-import.cmd
aufrufen (ggf. noch OSGEO4W_ROOT darin anpassen).  Ein ausreichend aktuelles
GDAL für Windows befindet sich im Unterverzeichnis gdal-dev.

Für Linux muß ein ausreichend aktuelles GDAL installiert sein und PyQt4, qt-sql
und python mapscript installiert werden.

In der Oberfläche muß man zum Import die Zugangsdaten zur Datenbank eingeben
und beim Erstbestand noch "Datenbestand anlegen" aktivieren.  Danach kann man
über "Datei hinzufügen..." einzelne Dateien bzw. "Verzeichnis hinzufügen" ganze
Verzeichnisse (mit Unterverzeichnissen) angeben und so die Dateiliste mit den
einzulesenden NAS-Daten füllen.  Danach "Starten" um den Import auszuführen.

Dadurch wird dann das Schema angelegt, die Dateien einzeln per ogr2ogr
eingelesen und am Ende die Ableitungsregeln ausgeführt und im Anschluß die
Liegenschaftsbuchdaten aufbereitet (in unser ALB-Modell).

Alternativ kann man auch alkis-import.sh ausführen, um das gleiche zu
erreichen.  Hierzu erstellt man eine Dateiliste in einer Datei.  Z.B. mit

	find . -name "*.xml" >nas.lst

und ergänzt oben in der Datei eine Zeile mit den Zugangsdaten zur Datenbank in
OGR-Notation (z.B. PG:dbname=alkis user=alkis password=alkis) und eine Zeile
mit "create", um das Anlegen des Schemas auszulösen und eine weitere mit "log"
um eine Logdatei zu erzeugen (ohne Argumente erzeugt "log" eine Protokolldatei,
die den Namen der Dateiliste plus Timestamp und .log statt .lst hat).

Neben den unkomprimierten .xml-Dateien werden auch .gz und .zip-Dateien
unterstützt.  Bei letzteren wird vorausgesetzt, dass sie jeweils nur eine
XML-Datei enthalten, deren Name bis auf die Erweiterung .xml statt .zip mit dem
des Archivs übereinstimmt.

nas.lst:
PG:dbname=alkis user=alkis password=alkis
create
log
1.xml
2.xml
3.xml
...


./alkis-import.sh nas.lst startet dann den Import.

Protokolle werden allerdings in beiden Varianten auch in die Datenbank
geschrieben.


ALKIS-Plugin für QGIS
---------------------

Das ALKIS-Plugin befindet sich im Verzeichnis alkisplugin.   Die Dateien
sollten in ~/.qgis2/python/plugins/alkisplugin bzw.
%USERPROFILE%\.qgis2\python\plugins\alkisplugin kopiert werden 

Nach dem Aktivieren kann man die Datenbankverbindung über den Menüpunkt
Datenbank/ALKIS/Konfiguration festlegen und mit "ALKIS-Layer einbinden" in das
QGIS-Projekt übernehmen.

Danach können über den ALKIS-Toolbar per "Beschriftungen suchen" Texte in der
Karte gesucht und "Flurstücksnachweis" eine Informationsmaske zu einem
angeklickten Flurstück anzeigen.   "Hervorhebung entfernen" löscht die
Markierung aus der Beschriftungssuche und Flurstücksnachweis.

Über den Menüpunkt "UMN-Mapserver-Datei anlegen" kann ein Mapfile erzeugt
werden (nur sichtbar, wenn python mapsscript installiert ist).
